<head>
  <title>buddy</title>
<script type="text/javascript">

    var clientId = '757859387382-vb4q7m2v5crqjg2tm1gvd1t5pj9ovo1c.apps.googleusercontent.com';

    var apiKey = 'AIzaSyB-xWo6qxFMF8i84iuhC4fUStlC4hNwWkY';

    var scopes = 'https://spreadsheets.google.com/feeds';

    function handleClientLoad() {
        // Step 2: Reference the API key
        console.log("Hello!");
        gapi.client.setApiKey(apiKey);
        window.setTimeout(checkAuth,1);
        console.log("Hello!");
    }

    function checkAuth() {
        gapi.auth.authorize({client_id: clientId, scope: scopes, immediate: true}, handleAuthResult);
    }

    function handleAuthResult(authResult) {
        var authorizeButton = document.getElementById('authorize-button');
        if (authResult && !authResult.error) {
            authorizeButton.style.visibility = 'hidden';
            makeApiCall();
        } else {
            authorizeButton.style.visibility = '';
            authorizeButton.onclick = handleAuthClick;
        }
    }

    function handleAuthClick(event) {
        // Step 3: get authorization to use private data
        gapi.auth.authorize({client_id: clientId, scope: scopes, immediate: false}, handleAuthResult);
        return false;
    }

    // Load the API and make an API call.  Display the results on the screen.
    function makeApiCall() {
        // Step 4: Load the Google+ API
        gapi.client.load('sheets', 'v3').then(function() {
            // Step 5: Assemble the API request
            var request = gapi.client.plus.people.get({
            'userId': 'me'
            });
            // Step 6: Execute the API request
            request.then(function(resp) {
            var heading = document.createElement('h4');
            var image = document.createElement('img');
            image.src = resp.result.image.url;
            heading.appendChild(image);
            heading.appendChild(document.createTextNode(resp.result.displayName));

            document.getElementById('content').appendChild(heading);
            }, function(reason) {
            console.log('Error: ' + reason.result.error.message);
            });
        });
    }
</script>
<script type="text/javascript" src="https://apis.google.com/js/client.js?onload=handleClientLoad"></script>
</head>
<body>
<!--Add a button for the user to click to initiate auth sequence -->
<button id="authorize-button" style="visibility: hidden">Authorize</button>
</body>

<template name="hello">
  <button>Click Me</button>
  <p>You've pressed the button {{counter}} times.</p>
  {{#each buddies}}
    {{> buddy}}
  {{/each}}
</template>

<template name="buddy">
  <p>{{hello}}</p>
</template>



